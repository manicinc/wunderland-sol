# =============================================================================
# VOICE-CHAT-ASSISTANT — Unified Environment Configuration
# =============================================================================
# Copy this file to .env and fill in values.
# Single source of truth. All apps (backend, rabbithole, wunderland-sh) read
# from this file. App-specific overrides go in <app>/.env.local (gitignored).
# =============================================================================

# =============================================================================
# GENERAL
# =============================================================================
NODE_ENV=development
# LOG_LEVEL=info
# NPM_TOKEN=

# =============================================================================
# BACKEND (NestJS — port 3001)
# =============================================================================
PORT=3001
FRONTEND_URL=http://localhost:3000
ADDITIONAL_CORS_ORIGINS=http://localhost:3010,http://localhost:3011,http://localhost:4200

# =============================================================================
# AUTH & SECURITY
# =============================================================================
JWT_SECRET=change-me-to-a-random-secret
# Used for AES-256-GCM encryption of stored secrets (agent credentials, job confidential details).
# Generate: `openssl rand -base64 32`
SETTINGS_ENCRYPTION_KEY=
ADMIN_PASSWORD=
SESSION_EXPIRY_DAYS=30

# Auth.js / NextAuth (rabbithole)  — generate: openssl rand -base64 32
AUTH_SECRET=
AUTH_TRUST_HOST=true

# Google OAuth (optional)
# AUTH_GOOGLE_ID=
# AUTH_GOOGLE_SECRET=
# NEXT_PUBLIC_OAUTH_GOOGLE=true

# GitHub OAuth (optional)
# AUTH_GITHUB_ID=
# AUTH_GITHUB_SECRET=
# NEXT_PUBLIC_OAUTH_GITHUB=true

# Canonical site URLs (used by checkout callbacks and emails)
RABBITHOLE_SITE_URL=https://rabbithole.inc
WUNDERLAND_SITE_URL=https://wunderland.sh

# =============================================================================
# STRIPE BILLING (optional — leave blank to disable)
# =============================================================================
STRIPE_SECRET_KEY=
STRIPE_WEBHOOK_SECRET=
STRIPE_STARTER_PRICE_ID=
STRIPE_PRO_PRICE_ID=
# Shared internal secret for server-to-server callbacks.
# Generate: `openssl rand -base64 32`
# Required for OAuth callbacks + Stripe sync.
INTERNAL_API_SECRET=

# =============================================================================
# EMAIL (Resend — optional)
# =============================================================================
RESEND_API_KEY=
EMAIL_FROM=noreply@example.com
EMAIL_SUPPORT=support@example.com

# =============================================================================
# LLM PROVIDERS
# =============================================================================
OPENAI_API_KEY=
ANTHROPIC_API_KEY=
OPENROUTER_API_KEY=

# OLLAMA (Local LLM — free)
OLLAMA_BASE_URL=http://localhost:11434
OLLAMA_ENABLED=false
OLLAMA_MODEL=dolphin-llama3:8b
OLLAMA_EMBED_MODEL=nomic-embed-text
# OLLAMA_EMBEDDING_MODEL=nomic-embed-text  # deprecated alias (kept for backwards compatibility)
# LLM_FORCE_PROVIDER=ollama
# Note: embeddings/RAG will only use Ollama when `OLLAMA_ENABLED=true` (or when explicitly selected via `*_EMBED_PROVIDER=ollama`).

# =============================================================================
# AGENT TOOL API KEYS (all optional)
# =============================================================================
SERPER_API_KEY=
NEWSAPI_API_KEY=
GIPHY_API_KEY=
ELEVENLABS_API_KEY=
GITHUB_TOKEN=

# =============================================================================
# MEDIA / IMAGE APIS (all optional)
# =============================================================================
PEXELS_API_KEY=
PIXABAY_API_KEY=
UNSPLASH_ACCESS_KEY=

# =============================================================================
# MESSAGING CHANNELS (on-premise agent hosting)
# =============================================================================
TELEGRAM_BOT_TOKEN=
DISCORD_BOT_TOKEN=
SLACK_BOT_TOKEN=
SLACK_APP_TOKEN=
SLACK_SIGNING_SECRET=
# WHATSAPP_SESSION_DATA=
# SIGNAL_PHONE_NUMBER=

# =============================================================================
# OAUTH CHANNEL APPS (SaaS multi-tenant — platform-level credentials)
# =============================================================================
# Slack OAuth V2 App (create at api.slack.com/apps)
SLACK_OAUTH_CLIENT_ID=
SLACK_OAUTH_CLIENT_SECRET=

# Discord OAuth Bot App (create at discord.com/developers)
DISCORD_OAUTH_CLIENT_ID=
DISCORD_OAUTH_CLIENT_SECRET=
DISCORD_OAUTH_BOT_TOKEN=

# OAuth callback base URL (defaults to FRONTEND_URL)
# OAUTH_CALLBACK_BASE_URL=https://rabbithole.inc

# =============================================================================
# VOICE / SMS TELEPHONY (optional — for voice calls)
# =============================================================================
TWILIO_ACCOUNT_SID=
TWILIO_AUTH_TOKEN=
TWILIO_PHONE_NUMBER=
# TELNYX_API_KEY=
# TELNYX_CONNECTION_ID=
# PLIVO_AUTH_ID=
# PLIVO_AUTH_TOKEN=

# =============================================================================
# ADDITIONAL LLM PROVIDERS (optional)
# =============================================================================
GEMINI_API_KEY=

# =============================================================================
# RAG QUALITY (optional — improves retrieval accuracy)
# =============================================================================
COHERE_API_KEY=

# =============================================================================
# SEARCH (optional alternatives)
# =============================================================================
BRAVE_API_KEY=

# =============================================================================
# PRODUCTIVITY INTEGRATIONS (optional)
# =============================================================================
# NOTION_API_KEY=
# TRELLO_API_KEY=
# TRELLO_TOKEN=

# =============================================================================
# P1 CHANNELS (uncomment as needed)
# =============================================================================
# MATRIX_HOMESERVER_URL=
# MATRIX_ACCESS_TOKEN=
# TEAMS_APP_ID=
# TEAMS_APP_SECRET=
# LINE_CHANNEL_ACCESS_TOKEN=
# LINE_CHANNEL_SECRET=
# MATTERMOST_URL=
# MATTERMOST_TOKEN=

# =============================================================================
# PROXY (optional — for scraping)
# =============================================================================
# PROXY_HOST=
# PROXY_PORT=
# PROXY_USERNAME=
# PROXY_PASSWORD=
# PROXY_URL=

# =============================================================================
# ML / EMBEDDINGS
# =============================================================================
EMBEDDING_CACHE_DIR=./.cache/transformers
EMBEDDING_MODEL=Xenova/all-MiniLM-L6-v2

# =============================================================================
# WUNDERLAND SOCIAL NETWORK
# =============================================================================
WUNDERLAND_ENABLED=false

# Wunderland.sh (Next) server-to-server proxy target for /api/* routes.
# Points at apps/wunderland-sh/backend (default port: 3001).
WUNDERLAND_BACKEND_URL=http://localhost:3001

# Solana on-chain anchoring
WUNDERLAND_SOL_ENABLED=false
WUNDERLAND_SOL_CLUSTER=devnet
WUNDERLAND_SOL_ENCLAVE_MODE=default
WUNDERLAND_SOL_ANCHOR_ON_APPROVAL=true
# WUNDERLAND_SOL_PROGRAM_ID=ExSiNgfPTSPew6kCqetyNcw8zWMo1hozULkZR1CSEq88
# WUNDERLAND_SOL_RPC_URL=https://api.devnet.solana.com

# Tips worker
WUNDERLAND_SOL_TIP_WORKER_ENABLED=false

# IPFS (Kubo) — required for content pinning
# Docker: set to http://ipfs:5001 (internal network)
# Systemd/host: set to http://127.0.0.1:5001
WUNDERLAND_IPFS_API_URL=http://127.0.0.1:5001
WUNDERLAND_IPFS_GATEWAY_URL=https://ipfs.io
WUNDERLAND_SOL_REQUIRE_IPFS_PIN=true

# Job scanning and autonomous execution
ENABLE_JOB_SCANNING=false
ENABLE_JOB_EXECUTION=false
JOB_EXECUTION_POLL_INTERVAL_MS=30000
JOB_EXECUTION_MAX_CONCURRENT=1
JOB_DELIVERABLE_STORAGE=hybrid
IPFS_API_URL=http://localhost:5001
JOB_QUALITY_THRESHOLD=0.7

# Social orchestration — agent browsing, autonomous posting, intro posts on mint.
# Requires WUNDERLAND_ENABLED=true and a running backend.
# Agents auto-register every 10s, browse every 5min, get post nudges every 20min.
ENABLE_SOCIAL_ORCHESTRATION=false

# World feed ingestion — polls HackerNews, arXiv, Reddit, NewsAPI, etc.
# Ingested articles become stimuli that agents respond to.
WUNDERLAND_WORLD_FEED_INGESTION_ENABLED=false
WUNDERLAND_WORLD_FEED_INGESTION_TICK_MS=30000

# AgentOS
AGENTOS_ENABLED=false

# QDRANT (optional: self-hosted via Docker or managed)
QDRANT_URL=http://localhost:6333
# QDRANT_API_KEY=
# QDRANT_TIMEOUT_MS=15000

# AgentOS RAG (backend ragService)
# AGENTOS_RAG_VECTOR_PROVIDER=sql               # sql|qdrant|hnswlib (default: sql)
# AGENTOS_RAG_QDRANT_URL=http://localhost:6333  # or set QDRANT_URL
# AGENTOS_RAG_QDRANT_API_KEY=                   # or set QDRANT_API_KEY
# AGENTOS_RAG_QDRANT_TIMEOUT_MS=15000
# AGENTOS_RAG_QDRANT_ENABLE_BM25=true
# AGENTOS_RAG_PRESET=balanced                   # fast|balanced|accurate
# AGENTOS_RAG_HNSWLIB_PERSIST_DIR=              # optional (directory). If empty, keeps HNSW in-memory only.

# AgentOS Multimodal RAG (image/audio; optional)
# AGENTOS_RAG_MEDIA_STORE_PAYLOAD=false         # store raw bytes in RAG DB (base64). Default: false
# AGENTOS_RAG_MEDIA_IMAGE_COLLECTION_ID=media_images
# AGENTOS_RAG_MEDIA_AUDIO_COLLECTION_ID=media_audio
# AGENTOS_RAG_MEDIA_IMAGE_LLM_PROVIDER=openai   # openai|openrouter (default: openai)
# AGENTOS_RAG_MEDIA_IMAGE_LLM_MODEL=gpt-4o-mini # model must support vision input
# Optional: offline image-to-image retrieval embeddings (requires Transformers.js installed)
# AGENTOS_RAG_MEDIA_IMAGE_EMBEDDINGS_ENABLED=false
# AGENTOS_RAG_MEDIA_IMAGE_EMBED_MODEL=Xenova/clip-vit-base-patch32
# AGENTOS_RAG_MEDIA_IMAGE_EMBED_COLLECTION_SUFFIX=_img
# AGENTOS_RAG_MEDIA_IMAGE_EMBED_CACHE_DIR=
# Optional: offline audio-to-audio retrieval embeddings (WAV-only on Node; requires Transformers.js + wavefile installed)
# AGENTOS_RAG_MEDIA_AUDIO_EMBEDDINGS_ENABLED=false
# AGENTOS_RAG_MEDIA_AUDIO_EMBED_MODEL=Xenova/clap-htsat-unfused
# AGENTOS_RAG_MEDIA_AUDIO_EMBED_COLLECTION_SUFFIX=_aud
# AGENTOS_RAG_MEDIA_AUDIO_EMBED_CACHE_DIR=

# AgentOS GraphRAG (optional; disabled by default)
# AGENTOS_GRAPHRAG_ENABLED=false
# AGENTOS_GRAPHRAG_CATEGORIES=knowledge_base    # default when unset
# AGENTOS_GRAPHRAG_COLLECTIONS=                 # optional allow list (comma-separated collection IDs)
# AGENTOS_GRAPHRAG_EXCLUDE_COLLECTIONS=         # optional deny list (comma-separated collection IDs)
# AGENTOS_GRAPHRAG_INDEX_MEDIA_ASSETS=false     # default: false
# AGENTOS_GRAPHRAG_MAX_DOC_CHARS=               # optional ingestion guardrail
# AGENTOS_GRAPHRAG_LLM_ENABLED=false            # enable for LLM extraction + summaries (slower/costly)
# AGENTOS_GRAPHRAG_LLM_PROVIDER=openai          # openai|openrouter|ollama (optional)
# AGENTOS_GRAPHRAG_LLM_MODEL=gpt-4o-mini        # optional override

# AgentOS HITL (human-in-the-loop) approvals (optional; disabled by default)
# AGENTOS_HITL_ENABLED=false
# AGENTOS_HITL_TIMEOUT_MS=30000                  # default request timeout inside HITL manager
# AGENTOS_HITL_APPROVAL_TIMEOUT_MS=30000         # per-tool approval timeout override (optional)
# AGENTOS_HITL_DEFAULT_SEVERITY=high             # low|medium|high|critical
# AGENTOS_HITL_REQUIRE_APPROVAL_FOR_SIDE_EFFECTS=true
# AGENTOS_HITL_WEBHOOK_URL=                      # optional outbound notification target(s), comma-separated
# AGENTOS_HITL_WEBHOOK_TIMEOUT_MS=5000
# AGENTOS_HITL_WEBHOOK_SECRET=                   # when set, decision endpoints require x-agentos-hitl-secret

# Wunderland Memory (per-seed vector memory for `memory_read`)
# WUNDERLAND_MEMORY_VECTOR_PROVIDER=sql               # sql|qdrant (default: sql)
# WUNDERLAND_MEMORY_QDRANT_URL=http://localhost:6333  # or set QDRANT_URL
# WUNDERLAND_MEMORY_QDRANT_API_KEY=                   # or set QDRANT_API_KEY
# WUNDERLAND_MEMORY_QDRANT_TIMEOUT_MS=15000
# WUNDERLAND_MEMORY_QDRANT_ENABLE_BM25=true
# WUNDERLAND_MEMORY_PRESET=balanced                   # fast|balanced|accurate

# =============================================================================
# OBSERVABILITY (OpenTelemetry - opt-in)
# =============================================================================

# Backend OTEL SDK bootstrap (backend/src/observability/otel.ts)
OTEL_ENABLED=false
# OTEL_SERVICE_NAME=voice-chat-assistant-backend
# OTEL_TRACES_EXPORTER=otlp
# OTEL_METRICS_EXPORTER=otlp
# OTEL_LOGS_EXPORTER=otlp
# OTEL_EXPORTER_OTLP_ENDPOINT=http://localhost:4318
# OTEL_EXPORTER_OTLP_PROTOCOL=http/protobuf
# OTEL_TRACES_SAMPLER=parentbased_traceidratio
# OTEL_TRACES_SAMPLER_ARG=0.1
# OTEL_DIAG_LOG_LEVEL=info

# AgentOS manual spans + correlation (packages/agentos/src/core/observability/otel.ts)
AGENTOS_OBSERVABILITY_ENABLED=false
# AGENTOS_TRACING_ENABLED=true
# AGENTOS_METRICS_ENABLED=true
# AGENTOS_TRACE_IDS_IN_RESPONSES=true
# AGENTOS_LOG_TRACE_IDS=true
# AGENTOS_OTEL_LOGS_ENABLED=true
# AGENTOS_OTEL_TRACER_NAME=@framers/agentos
# AGENTOS_OTEL_METER_NAME=@framers/agentos
# AGENTOS_OTEL_LOGGER_NAME=@framers/agentos

# =============================================================================
# NEXT_PUBLIC — Client-side vars (exposed to browser)
# =============================================================================
NEXT_PUBLIC_API_URL=http://localhost:3001/api
NEXT_PUBLIC_WUNDERLAND_ENABLE_CHAIN_PROOFS=false
# NEXT_PUBLIC_CLARITY_ID=

# Wunderland Sol UI
NEXT_PUBLIC_SOLANA_RPC=
NEXT_PUBLIC_PROGRAM_ID=ExSiNgfPTSPew6kCqetyNcw8zWMo1hozULkZR1CSEq88
NEXT_PUBLIC_CLUSTER=devnet
WUNDERLAND_ENCLAVE_NAMES=wunderland,governance,proof-theory,creative-chaos,machine-phenomenology,arena,meta-analysis

# Stimulus feed
STIMULUS_POLL_INTERVAL_MS=900000
STIMULUS_HACKERNEWS_ENABLED=true
STIMULUS_ARXIV_ENABLED=true
STIMULUS_MAX_ITEMS_PER_POLL=25

# =============================================================================
# RATE LIMITING & CREDITS
# =============================================================================
# Per-tier requests per minute (authenticated users)
RATE_LIMIT_PUBLIC_RPM=5
RATE_LIMIT_METERED_RPM=30
RATE_LIMIT_UNLIMITED_RPM=120
RATE_LIMIT_GLOBAL_RPM=15
# IP-based daily limit for unauthenticated users
RATE_LIMIT_PUBLIC_DAILY=10000

# Daily credit budgets (USD per day)
CREDITS_PUBLIC_LLM_DAILY_USD=0.05
CREDITS_PUBLIC_SPEECH_DAILY_USD=0.03
CREDITS_METERED_LLM_DAILY_USD=1.75
CREDITS_METERED_SPEECH_DAILY_USD=0.9
CREDITS_GLOBAL_LLM_DAILY_USD=0.45
CREDITS_GLOBAL_SPEECH_DAILY_USD=0.3

# Cost thresholds
COST_THRESHOLD_USD_PER_SESSION=2.00
GLOBAL_COST_THRESHOLD_USD_PER_MONTH=100.00
# DISABLE_COST_LIMITS=false

# Usage ledger retention (days)
USAGE_LEDGER_RETENTION_DAYS=90
