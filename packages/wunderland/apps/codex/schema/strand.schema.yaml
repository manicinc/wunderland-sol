$schema: "https://json-schema.org/draft/2020-12/schema"
title: StrandFrontmatter
type: object
required: [id, slug, title, version, contentType]
properties:
  id: { type: string, format: uuid }
  slug: { type: string, pattern: "^[a-z0-9-]+$" }
  title: { type: string }
  summary:
    type: string
    description: "Deprecated alias retained for backward compatibility. Use extractiveSummary instead."
  extractiveSummary:
    type: string
    description: "Deterministic summary generated by the static NLP pipeline (TF-IDF, n-grams)."
  aiSummary:
    type: string
    description: "Optional abstractive summary produced by LLM providers."
  notes:
    type: array
    items: { type: string }
    description: "Curated bullet notes for this strand."
  version: { type: string, pattern: "^\\d+\\.\\d+\\.\\d+$" }
  contentType:
    type: string
    enum: [lesson, reference, exercise, assessment, project, discussion, resource]
  difficulty:
    type: object
    properties:
      overall: { enum: [beginner, intermediate, advanced, expert] }
      cognitive: { type: number, minimum: 1, maximum: 10 }
      prerequisites: { type: number, minimum: 0, maximum: 10 }
      conceptual: { type: number, minimum: 1, maximum: 10 }
  taxonomy:
    type: object
    properties:
      subject: { type: array, items: { type: string } }
      topic: { type: array, items: { type: string } }
      subtopic: { type: array, items: { type: string } }
      concepts:
        type: array
        items:
          type: object
          properties:
            term: { type: string }
            weight: { type: number, minimum: 0, maximum: 1 }
  relationships:
    type: array
    items:
      type: object
      properties:
        targetSlug: { type: string }
        type: { enum: [follows, parallels, contrasts, extends, applies, synthesizes] }
        strength: { type: number, minimum: 0, maximum: 1 }
        bidirectional: { type: boolean, default: false }
  publishing:
    type: object
    properties:
      status: { enum: [draft, review, published, archived] }
      license: { type: string, default: MIT }
  blocks:
    type: array
    description: "Block-level tags and metadata for granular content organization. Auto-generated by NLP pipeline."
    items:
      type: object
      required: [id, line, type]
      properties:
        id:
          type: string
          description: "Heading slug (e.g., 'introduction') or generated block ID (e.g., 'block-42')"
        line:
          type: integer
          minimum: 1
          description: "Starting line number in the markdown file"
        endLine:
          type: integer
          minimum: 1
          description: "Ending line number (inclusive)"
        type:
          type: string
          enum: [heading, paragraph, code, list, blockquote, table, html]
          description: "Markdown block type"
        headingLevel:
          type: integer
          minimum: 1
          maximum: 6
          description: "Heading level (1-6) if type is 'heading'"
        tags:
          type: array
          items: { type: string }
          description: "Accepted/confirmed tags for this block"
        suggestedTags:
          type: array
          description: "Pending tag suggestions awaiting review"
          items:
            type: object
            required: [tag, confidence, source]
            properties:
              tag: { type: string }
              confidence:
                type: number
                minimum: 0
                maximum: 1
                description: "Confidence score (0-1)"
              source:
                type: string
                enum: [inline, nlp, llm, existing, user]
                description: "How the tag was suggested: inline (explicit #hashtag), nlp (vocabulary/TF-IDF), llm (AI), existing (propagated), user (manual)"
              reasoning:
                type: string
                description: "Optional explanation for AI-suggested tags"
        worthiness:
          type: object
          description: "Worthiness scoring for intelligent tagging prioritization"
          properties:
            score:
              type: number
              minimum: 0
              maximum: 1
              description: "Overall worthiness score (>=0.5 = worthy of tagging)"
            signals:
              type: object
              description: "Individual signal scores contributing to worthiness"
              properties:
                topicShift:
                  type: number
                  minimum: 0
                  maximum: 1
                  description: "How much this block shifts topic from previous"
                entityDensity:
                  type: number
                  minimum: 0
                  maximum: 1
                  description: "Named entity density in this block"
                semanticNovelty:
                  type: number
                  minimum: 0
                  maximum: 1
                  description: "Semantic distance from document centroid"
                structuralImportance:
                  type: number
                  minimum: 0
                  maximum: 1
                  description: "Importance based on heading level, position"
        extractiveSummary:
          type: string
          description: "Auto-generated extractive summary of the block"
        warrantsIllustration:
          type: boolean
          default: false
          description: "Whether this block would benefit from visual aids"